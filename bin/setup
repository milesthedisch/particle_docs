#!/usr/bin/env node

// Theres probably a better way to do this but watever this works for me.
// Get the nodemodule particle lib and write the file in to the public vendor
// folder.
const fse = require("fs-extra");
const path = require("path");

const pathToParticleLib = require.resolve("particle_library");
const pathToDocs = path.resolve(`${pathToParticleLib}/../docs`);

const outputLib = path.resolve(__dirname, "../src/vendor/particle_lib.js");
const outputDocs = path.resolve(__dirname, "../public/files/docs");

const writeLibraryIn = () =>
  new Promise((resolve, reject) => {
    fse.copy(pathToParticleLib, outputLib, function(err) {
      if (err) {
        reject(err);
      }
      console.log("Copied in library successfully!");
      resolve(null);
    });
  });

const writeDocsIn = () =>
  new Promise((resolve, reject) => {
    fse.copy(pathToDocs, outputDocs, function(err) {
      if (err) {
        console.log(err);
        reject(err);
      }
      console.log("Copied in docs successfully!");
      resolve(null);
    });
  });

Promise.all([writeDocsIn(), writeLibraryIn()])
  .catch((err) => console.error(err));
